1) Setup HDP.
2) edit these files:
/etc/puppet/agent/modules/hdp-hadoop/templates/core-site.xml.erb
/etc/puppet/master/modules/hdp-hadoop/templates/core-site.xml.erb
a) change all hadoop.proxyuser.(service_name).host and hadoop.proxyuser.(service_name).group to *
b) add 
<property>
  <name>hadoop.proxyuser.hue.hosts</name>
  <value>*</value>
</property>
<property>
  <name>hadoop.proxyuser.hue.groups</name>
  <value>*</value>
</property>
to the end of the file
3) edit these files:
/etc/puppet/agent/modules/hdp-hadoop/templates/hdfs-site.xml.erb
/etc/puppet/master/modules/hdp-hadoop/templates/hdfs-site.xml.erb
a) Change dfs.block.access.token.enable to false
b) Change dfs.permissions to false
c) Change dfs.web.ugi to hue,hue
d) Change dfs.http.adres to localhost:50070
e) Add dfs.support.broken.append to true

4) edit these files:
/etc/puppet/agent/modules/hdp-hadoop/templates/mapred-site.xml.erb
/etc/puppet/master/modules/hdp-hadoop/templates/mapred-site.xml.erb
a) Add:
<property>
  <name>mapred.jobtracker.completeuserjobs.maximum</name>
  <value>1000</value>
</property>
<property>
  <name>mapred.jobtracker.retirejob.interval</name>
  <value>86400000</value>
</property>

b) Set 

<property>
  <name>jobtracker.thrift.address</name>
  <value>0.0.0.0:9290</value>
</property>
<property>
  <name>mapreduce.jobtracker.plugins</name>
  <value>org.apache.hadoop.thriftfs.ThriftJobTrackerPlugin</value>
  <description>Comma-separated list of jobtracker plug-ins to be activated.</description>
</property>


5) edit these files:
/etc/puppet/agent/modules/hdp-oozie/templates/oozie-site.xml.erb
/etc/puppet/master/modules/hdp-oozie/templates/oozie-site.xml.erb
a) Add:
<property>
    <name>oozie.service.ProxyUserService.proxyuser.hue.hosts</name>
    <value>*</value>
</property>
<property>
    <name>oozie.service.ProxyUserService.proxyuser.hue.groups</name>
    <value>*</value>
</property>

6) edit these files:
/etc/puppet/agent/modules/hdp-hive/templates/hive-site.xml.erb
/etc/puppet/master/modules/hdp-hive/templates/hive-site.xml.erb

a) Change hive.security.authorization.enabled to false
b) Remove this property:
<property>
    <name>hive.security.authorization.manager</name>
    <value>org.apache.hcatalog.security.HdfsAuthorizationProvider</value>
    <description>the hive client authorization manager class name.
    The user defined authorization class should implement interface org.apache.hadoop.hive.ql.security.authorization.HiveAuthorizationProvider.  </description>
  </property>

7) yum install git ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi gcc gcc-c++ krb5-devel libxml2-devel libxslt-devel mysql  mysql-devel openldap-devel python-devel python-simplejson sqlite-devel
8) 
cd /home
wget http://apache.vc.ukrtel.net/maven/maven-3/3.0.4/binaries/apache-maven-3.0.4-bin.tar.gz
tar xvf apache-maven-3.0.4-bin.tar.gz 
export M2_HOME=/home/apache-maven-3.0.4 
export M2=$M2_HOME/bin 
export PATH=$M2:$PATH
git clone http://github.com/cloudera/hue.git hue_src && cd hue_src

Make this changes 
Edit: desktop/libs/hadoop/java/src/main/java/org/apache/hadoop/mapred/ThriftJobTrackerPlugin.java

on line 106: 
current:  public class ThriftJobTrackerPlugin extends JobTrackerPlugin implements Configurable {
Modify to : public class ThriftJobTrackerPlugin implements org.apache.hadoop.util.ServicePlugin, Configurable { 

on line 661: 
current:  public static final Log LOG = LogFactory.getLog(JobTrackerPlugin.class.getName());
modify to: public static final Log LOG = LogFactory.getLog(ThriftJobTrackerPlugin.class.getName()); 


9) PREFIX=/home make install

10) cd /home/hue
cp desktop/libs/hadoop/java-lib/hue-plugins-2.1.0-SNAPSHOT.jar /usr/lib/hadoop/lib/hue-plugins-2.1.0-SNAPSHOT.jar

11) Go to web HMC manager
12) Select Configure HDFS. Select WebHDFS enabled. It will restart cluster
13) cd /home/hue/desktop/conf
cp pseudo-distributed.ini.tmpl hue.ini
14) edit hue.ini
a) Set fs_defaultfs like this: fs_defaultfs=hdfs://ip-10-189-55-236.ec2.internal:8020
b) Set hadoop_hdfs_home=/usr/lib/hadoop
c) Set hadoop_mapred_home=/usr/lib/hadoop/lib
d) Add to the end of the file:
[proxy]
whitelist="(localhost|127\.0\.0\.1):(50030|50070|50060|50075|50111)",
15) useradd hue -M
16) yum install supervisor
17) edit /etc/supervisord.conf
Add:
[program:hue]
command=/home/hue/build/env/bin/supervisor            ; the program (relative uses PATH, can take args)
;priority=999                ; the relative start priority (default 999)
autostart=true              ; start at supervisord start (default: true)
autorestart=true            ; retstart at unexpected quit (default: true)
;startsecs=10                ; number of secs prog must stay running (def. 10)
;startretries=3              ; max # of serial start failures (default 3)
;exitcodes=0,2               ; 'expected' exit codes for process (default 0,2)
;stopsignal=QUIT             ; signal used to kill process (default TERM)
;stopwaitsecs=10             ; max num secs to wait before SIGKILL (default 10)
user=hue                 ; setuid to this UNIX account to run the program
;log_stdout=true             ; if true, log program stdout (default true)
;log_stderr=true             ; if true, log program stderr (def false)
;logfile=/var/log/cat.log    ; child log path, use NONE for none; default AUTO
;logfile_maxbytes=1MB        ; max # logfile bytes b4 rotation (default 50MB)
;logfile_backups=10          ; # of logfile backups (default 10)
18) /etc/init.d/supervisord start
