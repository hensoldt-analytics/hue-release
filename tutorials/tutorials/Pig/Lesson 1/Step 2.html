<html>
  <head>
    <title>Working with Data in Pig</title>
  </head>
  <body>
    <h3>Working with Data in Pig</h3>
    <p>Once again, we load our data and DESCRIBE it.</p>
    <pre line="1" lang="pig">daily_ticker = load '/user/hdfs/stock.txt.gz' using PigStorage() as (
  stock_symbol:chararray,
  date:chararray,
  stock_price_open:float,
  stock_price_high:float,
  stock_price_low:float,
  stock_price_close:float,
  stock_volume:long,
  stock_price_adj_close:float );

describe daily_ticker</pre>
    <p>Once again, describe shows us the schema of our data:</p>
    <pre line="1">daily_ticker: {
      stock_symbol: chararray,
      date: chararray,
      stock_price_open: float,
      stock_price_high: float,
      stock_price_low: float,
      stock_price_close: float,
      stock_volume: long,
      stock_price_adj_close: float
  }</pre>
    <p>Now lets group our data by the <code>stock_symbol</code>, so we can look at each stock separately.</p>
    <pre line="1" lang="pig"></pre>
    <pre line="1" lang="pig">by_symbol: {
  group: chararray,
  daily_ticker: {
    (stock_symbol: chararray,date: chararray,stock_price_open: float,stock_price_high: float,stock_price_low: float,stock_price_close: float,stock_volume: long,stock_price_adj_close: float)
    }
  }</pre>
  </body>
</html>